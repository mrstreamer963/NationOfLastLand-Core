```
pub enum UnitState {
    IsMoving,
    IsWaitingTarget,
    IsStopped
}
```

В HECS (и аналогичных ECS библиотеках вроде Specs или Bevy) `query_mut` поддерживает фильтры только по типам компонентов (наличие/отсутствие через `With`/`Without`), а не по их конкретным значениям. Поэтому фильтровать по значению `UnitState::IsMoving` напрямую в `query` нельзя — приходится проверять условие внутри цикла, как в вашем коде.

Если вы хотите избежать проверки в цикле и повысить производительность, рассмотрите рефакторинг: сделайте состояния отдельными компонентами вместо enum. Например:

- `IsMoving` — маркерный компонент вместо `UnitState::IsMoving`
- `WaitingTarget` — вместо `UnitState::IsWaitingTarget`
- Аналогично для `Stopped`

